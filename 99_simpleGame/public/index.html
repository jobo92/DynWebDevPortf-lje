<html>
<head>
<title>Index</title>

<script src="jquery-3.3.1.min.js"></script>
<script>

$(document).ready(function(){

	    let arrayHighScore = [];
    
    /*$('input:submit').on('click',function(evt){
		evt.preventDefault();
		console.log( 'submitting form with Ajax...' );
		*/
		$.ajax({
		  type: "POST",
		  url: "http://localhost:9999/",
		  dataType: "json",
		  data: JSON.stringify({
				//todo: $('#the_text').val()
								})
		}).done(function ( data ) {
			console.log( data );
           
            arrayHighScore = data;
            inputUsername();
			
			let elements = $();
			for(let i=0; i<data.length;i++) {
				elements = elements.add('<li>'+data[i].username + ': '+ data[i].bestScore +'</li>');
			}
			$('#todolist').empty();
			$('#todolist').append(elements);     
			//$('#the_text').val('');
		});
    
        function inputUsername() {
            let username = prompt("Enter your username");
            $("#userNameField").text("Your username is: " + username);
            $("#userNameField").after( "<div id='hasHighScore'> You don't have a highscore yet</div>" );
            for (i = 0; i < arrayHighScore.length; i++) {
                if (arrayHighScore[i].username == username) {
                    $("#hasHighScore").text("You have a highscore of: " + arrayHighScore[i].bestScore);
                } 
            }
        } //End of inputUsername()
    
        
    
        $('input:submit').on('click',function(evt){
		  evt.preventDefault();
		  console.log( 'submitting form with Ajax...' );
		$.ajax({
		  type: "POST",
		  url: "http://localhost:9999/",
		  dataType: "json",
		  data: JSON.stringify({arrayHighScore})
		}).done(function ( data ) {
			console.log( data );
		  });
        }); //End of $('input:submit')

});	
</script>
</head>
<body>
    <h1>Highscore:</h1>
<!--<h1>A simple 'To Do' list</h1>
	-<form method="POST">
	New thing to do:
	<input type="text" id='the_text' name="todo"/>
	<input type="submit" value="send"/>
	</form>-->
	
	<div id="todolist"></div>
    <br><br>
    <div id="userNameField"></div>
    <form method="POST">
	Send highscore to node: 
	<input type="submit" value="Send"/>
	</form>
</body>
</html>	